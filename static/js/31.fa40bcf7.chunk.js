(this["webpackJsonpreact-test"]=this["webpackJsonpreact-test"]||[]).push([[31],{400:function(e,t,a){e.exports=a.p+"static/media/lazyImg.639beef7.jpg"},403:function(e,t,a){var s,i=function(e,t){e instanceof Object&&(this.opts=e,this.iMaxPage=this.opts.maxPage,this.fnCallback=t,this.iOffsetBottom=this.opts.offsetBottom,this.iCurPage=this.opts.curPage,this.init())};i.prototype={init:function(){this.eventScroll()},eventScroll:function(){window.addEventListener("scroll",this.scrollBottom())},scrollBottom:function(){var e=this,t=!0;return function(){t&&(t=!1,setTimeout((function(){var a=document.documentElement.offsetHeight||document.body.offsetHeight,s=document.documentElement.scrollTop||document.body.scrollTop;a-((document.documentElement.clientHeight||document.body.clientHeight)+s)<=e.iOffsetBottom&&e.iCurPage<e.iMaxPage&&(e.iCurPage++,e.fnCallback(e.iCurPage)),t=!0}),100))}}},e.exports?e.exports=i:void 0===(s=function(){return i}.call(t,a,t,e))||(e.exports=s)},516:function(e,t,a){e.exports={page:"search_page__2TU1u",hide:"search_hide__32PD3","search-top":"search_search-top__13gew","search-head":"search_search-head__2BJcL",back:"search_back__2nwiN","search-wrap":"search_search-wrap__1sF4E","search-icon":"search_search-icon__1wbIF","search-text":"search_search-text__zdY_o","screen-btn":"search_screen-btn__3hThd","order-main":"search_order-main__1_N9Q","order-item":"search_order-item__1eRMx",active:"search_active__3Q1Co","order-text":"search_order-text__pCueA","order-icon-up":"search_order-icon-up__3bTzf","order-icon":"search_order-icon__1JKW2","order-menu":"search_order-menu__9C2RK","goods-main":"search_goods-main__bn_2l","goods-list":"search_goods-list__14E3q",image:"search_image__1hjPT","goods-content":"search_goods-content__22w-D","goods-title":"search_goods-title__2eTSl","goods-price":"search_goods-price__1G6PX","goods-sales":"search_goods-sales__2ABMd",mask:"search_mask__2otpV",screen:"search_screen__2A91O",move:"search_move__vM0I-",unmove:"search_unmove__UOb6X","attr-wrap":"search_attr-wrap__2RtZQ","attr-title-wrap":"search_attr-title-wrap__2YUrK","attr-name":"search_attr-name__32gCr","price-wrap":"search_price-wrap__1FSsK","price-input":"search_price-input__1RtsY","price-line":"search_price-line__P1hSG","attr-icon-down":"search_attr-icon-down__3qiHv","attr-icon-up":"search_attr-icon-up__3zt89","item-wrap":"search_item-wrap__2CTUB",item:"search_item__1S0ck","handle-wrap":"search_handle-wrap__p_RjO",reset:"search_reset__1QG0W",sure:"search_sure__3Ea4i"}},577:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return _}));var s=a(52),i=a(53),c=a(55),r=a(54),n=a(1),h=a.n(n),o=a(7),l=a(382),d=a(426),m=a.n(d),u=a(385),p=a(427),f=a(516),v=a.n(f),k=a(403),g=a.n(k),_=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={screenMove:"",bMask:!1,bPriceMenu:!1,bSalesMenu:!1,pageStyle:{display:"none"},aGoods:[],aPriceOrder:[{title:"\u7efc\u5408",type:"all",checked:!0},{title:"\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8",type:"up",checked:!1},{title:"\u4ef7\u683c\u4ece\u9ad8\u5230\u4f4e",type:"down",checked:!1}],sKeywords:"",itemTotal:0,aClassify:{checked:!0,items:[]},aPrice:{checked:!0,items:[{price1:1,price2:50,checked:!1},{price1:51,price2:99,checked:!1},{price1:100,price2:300,checked:!1},{price1:301,price2:1e3,checked:!1},{price1:1001,price2:4e3,checked:!1},{price1:4001,price2:9999,checked:!1}]},fPrice1:0,fPrice2:0,aAttr:[]},a.myScroll=null,a.oUpRefresh=null,a.curPage=1,a.maxPage=0,a.offsetBottom=100,a.bPriceMenu=!1,a.bSalesMenu=!1,a.oType="all",a.sParams="",a.sKeywords="",a.cid="",a.fPrice1="",a.fPrice2="",a.sParam="",a.aParam=[],a.cid="",a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.myScroll=new m.a(this.refs.screen,{scrollX:!1,scrollY:!0,preventDefault:!1}),this.sKeywords=decodeURIComponent(Object(u.c)(this.props.location.search).search.keywords),this.setState({sKeywords:this.sKeywords}),this.getPageData(),this.getClassifyData(),this.getAttrData()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"showScreen",value:function(){this.refs.mask.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),this.refs.screen.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),this.setState({screenMove:v.a.move,bMask:!0})}},{key:"hideScreen",value:function(){this.setState({screenMove:v.a.unmove,bMask:!1})}},{key:"goBack",value:function(){this.props.history.goBack()}},{key:"handlePriceOrder",value:function(){this.bPriceMenu?(this.bPriceMenu=!1,this.setState({bPriceMenu:!1})):(this.bPriceMenu=!0,this.setState({bPriceMenu:!0})),this.bSalesMenu=!1,this.setState({bSalesMenu:!1})}},{key:"handleSalesOrder",value:function(){this.bSalesMenu||(this.bSalesMenu=!0,this.setState({bSalesMenu:!0})),this.bPriceMenu=!1,this.setState({bPriceMenu:!1}),this.oType="sales",this.getPageData()}},{key:"getStyle",value:function(e){this.setState({pageStyle:e})}},{key:"getPageData",value:function(){var e=this;this.setParams();var t=o.a.baseUrl+"/api/home/goods/search?"+this.sParams+"&page=1&token="+o.a.token;Object(l.a)(t).then((function(t){200===t.code?(e.setState({aGoods:t.data,itemTotal:t.pageinfo.total},(function(){Object(u.b)()})),e.maxPage=t.pageinfo.pagenum,e.getScrollPage()):e.setState({aGoods:[],itemTotal:0})}))}},{key:"getScrollPage",value:function(){var e=this;this.oUpRefresh=new g.a({curPage:this.curPage,maxPage:this.maxPage,offsetBottom:this.offsetBottom},(function(t){var a=o.a.baseUrl+"/api/home/goods/search?"+e.sParams+"&page="+t+"&token="+o.a.token;Object(l.a)(a).then((function(t){if(200===t.code&&t.data.length>0){for(var a=e.state.aGoods,s=0;s<t.data.length;s++)a.push(t.data[s]);e.setState({aGoods:a},(function(){Object(u.b)()}))}}))}))}},{key:"setParams",value:function(){this.sParams="kwords="+this.sKeywords+"&param="+this.sParam+"&price1="+this.fPrice1+"&price2="+this.fPrice2+"&otype="+this.oType+"&cid="+this.cid}},{key:"checkedPriceOrder",value:function(e){for(var t=this.state.aPriceOrder,a=0;a<t.length;a++)t[a].checked=!1;t[e].checked=!0,this.setState({aPriceOrder:t}),this.oType=t[e].type,this.getPageData()}},{key:"getChildKeywords",value:function(e){this.sKeywords=e,this.setState({sKeywords:e,pageStyle:{display:"none"}}),this.props.history.replace(o.a.path+"goods/search?keywords="+e),this.setReset(),this.getPageData(),this.getAttrData()}},{key:"handleClassify",value:function(){var e=this.state.aClassify;e.checked?e.checked=!1:e.checked=!0,this.setState({aClassify:e})}},{key:"checkedClassify",value:function(e){var t=this.state.aClassify;if(t.items.length>0){for(var a=0;a<t.items.length;a++)a!==e&&(t.items[a].checked=!1);t.items[e].checked?(t.items[e].checked=!1,this.cid=""):(t.items[e].checked=!0,this.cid=t.items[e].cid),this.setState({aClassify:t})}}},{key:"handlePrice",value:function(){var e=this.state.aPrice;e.checked?e.checked=!1:e.checked=!0,this.setState({aPrice:e})}},{key:"checkedPrice",value:function(e,t,a){var s=this.state.aPrice;if(s.items.length>0){for(var i=0;i<s.items.length;i++)i!==e&&(s.items[i].checked=!1);s.items[e].checked?(s.items[e].checked=!1,t=0,a=0,this.fPrice1="",this.fPrice2=""):(s.items[e].checked=!0,this.fPrice1=t,this.fPrice2=a),this.setState({aPrice:s,fPrice1:t,fPrice2:a})}}},{key:"preventBubble",value:function(e){e.stopPropagation()}},{key:"changePrice1",value:function(e){var t=this;this.setState({fPrice1:e.target.value.replace(/[a-zA-Z]|[\u4e00-\u9fa5]|[#|*|,|+|;]/g,"")},(function(){t.fPrice1=t.state.fPrice1}))}},{key:"changePrice2",value:function(e){var t=this;this.setState({fPrice2:e.target.value.replace(/[a-zA-Z]|[\u4e00-\u9fa5]|[#|*|,|+|;]/g,"")},(function(){t.fPrice2=t.state.fPrice2}))}},{key:"handleAttr",value:function(e){var t=this.state.aAttr;t[e].checked?t[e].checked=!1:t[e].checked=!0,this.setState({aAttr:t})}},{key:"checkedParams",value:function(e,t){var a=this.state.aAttr;if(a[e].param[t].checked){a[e].param[t].checked=!1;for(var s=0;s<this.aParam.length;s++)if(this.aParam[s]===a[e].param[t].pid){this.aParam.splice(s--,1);break}}else a[e].param[t].checked=!0,this.aParam.push(a[e].param[t].pid);this.sParam=this.aParam.length>0?JSON.stringify(this.aParam):"",this.setState({aAttr:a})}},{key:"getClassifyData",value:function(){var e=this,t=o.a.baseUrl+"/api/home/category/menu?token="+o.a.token;Object(l.a)(t).then((function(t){if(200===t.code){var a=e.state.aClassify;a.items=t.data;for(var s=0;s<t.data.length;s++)a.items[s].checked=!1;e.setState({aClassify:a},(function(){e.myScroll.refresh()}))}}))}},{key:"getAttrData",value:function(){var e=this,t=o.a.baseUrl+"/api/home/goods/param?kwords="+this.sKeywords+"&token="+o.a.token;Object(l.a)(t).then((function(t){if(200===t.code){for(var a=t.data,s=0;s<a.length;s++)if(a[s].checked=!0,a[s].param.length>0)for(var i=0;i<a[s].param.length;i++)a[s].param[i].checked=!1;e.setState({aAttr:a},(function(){e.myScroll.refresh()}))}else e.setState({aAttr:[]})}))}},{key:"goSearch",value:function(){this.hideScreen(),this.getPageData()}},{key:"setReset",value:function(){this.sParam="",this.aParam=[],this.cid="",this.fPrice1="",this.fPrice2="",this.oType="all";var e=this.state.aClassify;if(e.items.length>0)for(var t=0;t<e.items.length;t++)e.items[t].checked=!1;for(var a=this.state.aPrice,s=0;s<a.items.length;s++)a.items[s].checked=!1;var i=this.state.aAttr;if(i.length>0)for(var c=0;c<i.length;c++)if(i[c].param.length>0)for(var r=0;r<i[c].param.length;r++)i[c].param[r].checked=!1;this.setState({fPrice1:0,fPrice2:0,aClassify:e,aPrice:a,aAttr:i})}},{key:"pushPage",value:function(e){this.props.history.push(o.a.path+e)}},{key:"render",value:function(){var e=this;return h.a.createElement("div",{className:v.a.page},h.a.createElement("div",{className:v.a["search-top"]},h.a.createElement("div",{className:v.a["search-head"]},h.a.createElement("div",{className:v.a.back,onClick:this.goBack.bind(this)}),h.a.createElement("div",{className:v.a["search-wrap"],onClick:this.getStyle.bind(this,{display:"block"})},h.a.createElement("div",{className:v.a["search-icon"]}),h.a.createElement("div",{className:v.a["search-text"]},"\u8f93\u5165\u5b9d\u8d1d\u540d\u79f0")),h.a.createElement("div",{className:v.a["screen-btn"],onClick:this.showScreen.bind(this)},"\u7b5b\u9009")),h.a.createElement("div",{className:v.a["order-main"]},h.a.createElement("div",{className:this.state.bPriceMenu?v.a["order-item"]+" "+v.a.active:v.a["order-item"],onClick:this.handlePriceOrder.bind(this)},h.a.createElement("div",{className:v.a["order-text"]},"\u7efc\u5408"),h.a.createElement("div",{className:v.a["order-icon"]}),h.a.createElement("ul",{className:this.state.bPriceMenu?v.a["order-menu"]:v.a["order-menu"]+" "+v.a.hide},this.state.aPriceOrder.map((function(t,a){return h.a.createElement("li",{key:a,className:t.checked?v.a.active:"",onClick:e.checkedPriceOrder.bind(e,a)},t.title)})))),h.a.createElement("div",{className:this.state.bSalesMenu?v.a["order-item"]+" "+v.a.active:v.a["order-item"],onClick:this.handleSalesOrder.bind(this)},h.a.createElement("div",{className:v.a["order-text"]},"\u9500\u91cf")))),h.a.createElement("div",{className:v.a["goods-main"]},this.state.aGoods.length>0?this.state.aGoods.map((function(t,s){return h.a.createElement("div",{key:s,className:v.a["goods-list"],onClick:e.pushPage.bind(e,"goods/details/item?gid="+t.gid)},h.a.createElement("div",{className:v.a.image},h.a.createElement("img",{"data-echo":t.image,src:a(400),alt:t.title})),h.a.createElement("div",{className:v.a["goods-content"]},h.a.createElement("div",{className:v.a["goods-title"]},t.title),h.a.createElement("div",{className:v.a["goods-price"]},"\xa5",t.price),h.a.createElement("div",{className:v.a["goods-sales"]},"\u9500\u91cf",h.a.createElement("span",null,t.sales),"\u4ef6")))})):h.a.createElement("div",{className:"null-item"},"\u6ca1\u6709\u76f8\u5173\u5546\u54c1!")),h.a.createElement("div",{ref:"mask",className:this.state.bMask?v.a.mask:v.a.mask+" "+v.a.hide,onClick:this.hideScreen.bind(this)}),h.a.createElement("div",{ref:"screen",className:v.a.screen+" "+this.state.screenMove},h.a.createElement("div",null,h.a.createElement("div",{className:v.a["attr-wrap"]},h.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:this.handleClassify.bind(this)},h.a.createElement("div",{className:v.a["attr-name"]},"\u5206\u7c7b"),h.a.createElement("div",{className:this.state.aClassify.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),h.a.createElement("div",{className:this.state.aClassify.checked?v.a["item-wrap"]:"hide"},this.state.aClassify.items.length>0?this.state.aClassify.items.map((function(t,a){return h.a.createElement("div",{key:a,className:t.checked?v.a.item+" "+v.a.active:v.a.item,onClick:e.checkedClassify.bind(e,a)},t.title)})):""),h.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:this.handlePrice.bind(this)},h.a.createElement("div",{className:v.a["attr-name"]},"\u4ef7\u683c\u533a\u95f4"),h.a.createElement("div",{className:v.a["price-wrap"]},h.a.createElement("div",{className:v.a["price-input"],onClick:this.preventBubble.bind(this)},h.a.createElement("input",{type:"tel",placeholder:"\u6700\u4f4e\u4ef7",value:0===this.state.fPrice1?"":this.state.fPrice1,onChange:this.changePrice1.bind(this)})),h.a.createElement("div",{className:v.a["price-line"]}),h.a.createElement("div",{className:v.a["price-input"],onClick:this.preventBubble.bind(this)},h.a.createElement("input",{type:"tel",placeholder:"\u6700\u9ad8\u4ef7",value:0===this.state.fPrice2?"":this.state.fPrice2,onChange:this.changePrice2.bind(this)}))),h.a.createElement("div",{className:this.state.aPrice.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),h.a.createElement("div",{className:this.state.aPrice.checked?v.a["item-wrap"]:"hide"},this.state.aPrice.items.map((function(t,a){return h.a.createElement("div",{onClick:e.checkedPrice.bind(e,a,t.price1,t.price2),key:a,className:t.checked?v.a.item+" "+v.a.active:v.a.item},t.price1,"-",t.price2)}))),h.a.createElement("div",{style:{width:"100%",height:"0.9rem",backgroundColor:"#efefef"}}),this.state.aAttr.length>0?this.state.aAttr.map((function(t,a){return h.a.createElement(h.a.Fragment,{key:a},h.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:e.handleAttr.bind(e,a)},h.a.createElement("div",{className:v.a["attr-name"]},t.title),h.a.createElement("div",{className:t.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),h.a.createElement("div",{className:t.checked?v.a["item-wrap"]:v.a["item-wrap"]+"height-hide"},t.param.length>0?t.param.map((function(t,s){return h.a.createElement("div",{key:s,className:t.checked?v.a.item+" "+v.a.active:v.a.item,onClick:e.checkedParams.bind(e,a,s)},t.title)})):""))})):""),h.a.createElement("div",{style:{width:"100%",height:"2%",backgroundColor:"#efefef"}}),h.a.createElement("div",{style:{width:"100%",height:"2.5rem",backgroundColor:"#ffffff"}})),h.a.createElement("div",{className:v.a["handle-wrap"]},h.a.createElement("div",{className:v.a.item},"\u5171",h.a.createElement("span",null,this.state.itemTotal),"\u4ef6"),h.a.createElement("div",{className:v.a.item+" "+v.a.reset,onClick:this.setReset.bind(this)},"\u5168\u90e8\u91cd\u7f6e"),h.a.createElement("div",{className:v.a.item+" "+v.a.sure,onClick:this.goSearch.bind(this)},"\u786e\u5b9a"))),h.a.createElement(p.a,{pageStyle:this.state.pageStyle,childStyle:this.getStyle.bind(this),isLocal:"1",childKeywords:this.getChildKeywords.bind(this),keywords:this.state.sKeywords}))}}]),n}(h.a.Component)}}]);
//# sourceMappingURL=31.fa40bcf7.chunk.js.map
{"version":3,"sources":["assets/css/home/goods/classify.module.css","pages/home/goods/classify.js"],"names":["module","exports","GoodsItems","asyncComponents","GoodsClassify","props","state","aClassify","pageStyle","display","myScroll","aTempClassify","cid","location","search","localParam","this","getClassifyData","setState","callback","pUrl","history","replace","config","path","goBack","scrollClassify","refs","addEventListener","e","preventDefault","passive","IScroll","scrollX","scrollY","request","baseUrl","token","then","res","code","data","i","length","bActive","eventScroll","defaultClassifyStyle","pIndex","replacePage","val","className","Css","onClick","bind","changeSearch","ref","map","item","index","key","changeStyle","title","isSystem","style","width","height","component","childStyle","getStyle","React","Component"],"mappings":"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","file":"static/js/36.cde90fd8.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"search-header\":\"classify_search-header__30aPJ\",\"back\":\"classify_back__2MgQO\",\"search\":\"classify_search__2T8Am\",\"goods-main\":\"classify_goods-main__9q6xU\",\"classify-wrap\":\"classify_classify-wrap__3fI1N\",\"classify-item\":\"classify_classify-item__1zwKr\",\"active\":\"classify_active__3ioHo\",\"goods-content\":\"classify_goods-content__ACf_4\"};","import React from 'react';\nimport  {Route,Switch}  from  'react-router-dom';\nimport asyncComponents from '../../../components/async/AsyncComponent';\nimport config from '../../../assets/js/conf/config.js';\nimport IScroll from '../../../assets/js/libs/iscroll.js';\nimport Css from '../../../assets/css/home/goods/classify.module.css';\nimport {request} from \"../../../assets/js/libs/request\";\nimport {localParam,isSystem} from \"../../../assets/js/utils/util\";\nimport SearchComponent from '../../../components/search/search';\nconst GoodsItems=asyncComponents(()=>import('./items'));\nexport default class  GoodsClassify extends React.Component{\n    constructor(props){\n        super(props);\n        this.state={\n            aClassify:[],\n            pageStyle:{display:\"none\"}\n        };\n        this.myScroll=null;\n        this.aTempClassify=[];\n        this.cid=props.location.search?localParam(props.location.search).search.cid:'492';\n    }\n    componentDidMount(){\n        this.getClassifyData();\n    }\n    componentWillUnmount(){\n        this.setState=(state,callback)=>{\n            return;\n        }\n    }\n    replacePage(pUrl){\n      this.props.history.replace(config.path+pUrl);\n    }\n    goBack(){\n        this.props.history.goBack();\n    }\n    eventScroll(){\n        let scrollClassify=this.refs['scroll-classify'];\n        scrollClassify.addEventListener('touchmove', function (e) { e.preventDefault(); },  {passive: false});\n        this.myScroll= new IScroll(scrollClassify, {\n            scrollX : false,\n            scrollY : true,\n            preventDefault : false\n        });\n\n    }\n    getClassifyData(){\n        request(config.baseUrl+\"/api/home/category/menu?token=\"+config.token).then(res =>{\n            if (res.code ===200){\n                this.aTempClassify=res.data;\n                for (let i=0;i<this.aTempClassify.length;i++){\n                    this.aTempClassify[i].bActive=false;\n                }\n                this.setState({aClassify:this.aTempClassify},()=>{\n                    this.eventScroll();\n                    this.defaultClassifyStyle();\n                })\n            }\n        } );\n    }\n    changeStyle(pUrl,pIndex){\n        if (this.aTempClassify.length>0){\n            for (let i=0;i<this.aTempClassify.length;i++){\n                this.aTempClassify[i].bActive=false;\n            }\n        }\n        this.aTempClassify[pIndex].bActive=true;\n        this.setState({aClassify:this.aTempClassify}); \n        //this.handleScroll(pIndex);\n        this.replacePage(pUrl);\n    }\n\n    //单击分类名单,点击到界面一半时将点击的分类滚动置顶,但存在bug:当滚动条的剩余长度不足以使点击的分类置顶时无法触发效果\n    /* handleScroll(pIndex){\n        \n        let oScrollClassify=this.refs['scroll-classify'];\n        let iTopHeight=Math.round(parseInt(this.refs['item-'+pIndex].offsetHeight)*pIndex);\n        let iHalfHeight=Math.round(oScrollClassify.offsetHeight/3);\n        let iBottomHeight=oScrollClassify.scrollHeight-iTopHeight;\n        if (iTopHeight>iHalfHeight && iBottomHeight>oScrollClassify.offsetHeight){\n            this.myScroll.scrollTo(0,-iTopHeight,300,IScroll.utils.ease.elastic);\n        }\n    } */\n    defaultClassifyStyle(){\n        if (this.aTempClassify.length>0){\n            for (let i=0;i<this.aTempClassify.length;i++){\n                if (this.aTempClassify[i].cid ===this.cid){\n                    this.aTempClassify[i].bActive=true;\n                    break;\n                }\n            }\n            this.replacePage('goods/classify/items?cid='+this.cid+'');\n            this.setState({aClassify:this.aTempClassify});\n        }\n    }\n    getStyle(val){\n        this.setState({\n            /* pageStyle:{'display':'none'} */\n            pageStyle:val\n        })\n    }\n    changeSearch(){\n        this.setState({pageStyle:{display:\"block\"}})\n    }\n    render(){\n        return(\n            <div>\n                <div className={Css['search-header']}>\n                    <div className={Css['back']} onClick={this.goBack.bind(this)}></div>\n                    <div className={Css['search']} onClick={this.changeSearch.bind(this)}>请输入宝贝名称</div>\n                </div>\n                <div className={Css['goods-main']}>\n                    <div ref=\"scroll-classify\" className={Css['classify-wrap']}>\n                        <div>\n                            {\n                                this.state.aClassify!=null?\n                                    this.state.aClassify.map((item, index)=>{\n                                        return(\n                                            <div ref={\"item-\"+index} className={item.bActive?Css['classify-item']+\" \"+Css['active']:Css['classify-item']} key={index} onClick={this.changeStyle.bind(this, 'goods/classify/items?cid='+item.cid+'',index)}>{item.title}</div>\n                                        )\n                                    })\n                                :\"\"\n                            }\n                            {\n                                isSystem()===1?<div style={{width:'100%',height:'2.5rem'}}></div>:<div style={{width:'100%',height:'2.2rem'}}></div>\n                            }\n                        </div>\n                    </div>\n                    <div className={Css['goods-content']}>\n                        <Switch>\n                            <Route path={config.path+\"goods/classify/items\"} component={GoodsItems}></Route>\n                        </Switch>\n                    </div>\n                </div>\n                <SearchComponent pageStyle={this.state.pageStyle} childStyle={this.getStyle.bind(this)}></SearchComponent>\n            </div>\n        );\n    }\n}"],"sourceRoot":""}
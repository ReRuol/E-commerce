{"version":3,"sources":["assets/images/common/lazyImg.jpg","assets/js/libs/uprefresh.js","pages/home/goods/details_reviews.js","assets/css/home/goods/details_reviews.module.css"],"names":["module","exports","UpRefresh","opts","callback","Object","this","iMaxPage","maxPage","fnCallback","iOffsetBottom","offsetBottom","iCurPage","curPage","init","prototype","eventScroll","window","addEventListener","scrollBottom","_this","bScroll","setTimeout","iScrollHeight","document","documentElement","offsetHeight","body","iScrollTop","scrollTop","clientHeight","define","DetailsReviews","props","state","aReviews","iReviewTotal","gid","location","search","localParam","oUpRefresh","getReviews","setState","sUrl","config","baseUrl","token","request","then","res","code","data","pageinfo","total","lazyImg","pagenum","getScrollPage","length","i","push","className","Css","map","item","index","key","alt","nickname","data-echo","head","src","require","content","times","React","Component"],"mappings":"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","file":"static/js/30.734d6248.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/lazyImg.639beef7.jpg\";","/*eslint-disable*/\nvar UpRefresh=function(opts,callback){\n    if(opts instanceof Object) {\n        this.opts = opts;\n        this.iMaxPage=this.opts.maxPage;\n        this.fnCallback=callback;\n        this.iOffsetBottom=this.opts.offsetBottom;\n        this.iCurPage=this.opts.curPage;\n        this.init();\n    }\n};\nUpRefresh.prototype={\n    init:function(){\n        var _this=this;\n        _this.eventScroll();\n    },\n    eventScroll:function(){\n        var _this=this;\n        window.addEventListener(\"scroll\",_this.scrollBottom());\n    },\n    scrollBottom:function(){\n        var _this=this;\n        var bScroll=true;\n        return function(){\n            if(!bScroll){\n                return;\n            }\n            bScroll=false;\n            setTimeout(function(){\n                //整个页面滚动条的高度\n                var iScrollHeight=document.documentElement.offsetHeight || document.body.offsetHeight;\n                //滚动到当前的距离\n                var iScrollTop=document.documentElement.scrollTop || document.body.scrollTop;\n                //整个窗体的高度\n                var iWinHeight=document.documentElement.clientHeight || document.body.clientHeight;\n                if(iScrollHeight-(iWinHeight+iScrollTop)<=_this.iOffsetBottom){\n                    if(_this.iCurPage<_this.iMaxPage) {\n                        _this.iCurPage++;\n                        _this.fnCallback(_this.iCurPage);\n                    }\n                }\n                bScroll=true;\n            },100);\n        }\n    }\n};\n\n//这个判断支持模块化比如react和vue\nif ( typeof module != 'undefined' && module.exports ) {\n    module.exports = UpRefresh;\n} else if ( typeof define == 'function' && define.amd ) {\n    define( function () { return UpRefresh; } );\n} else if(typeof window != \"undefined\") {\n    window.UpRefresh = UpRefresh;\n}\n\n","import React from 'react';\r\nimport config from '../../../assets/js/conf/config.js';\r\nimport {request} from \"../../../assets/js/libs/request\";\r\nimport {lazyImg,localParam} from '../../../assets/js/utils/util.js';\r\nimport Css from '../../../assets/css/home/goods/details_reviews.module.css';\r\nimport UpRefresh from '../../../assets/js/libs/uprefresh';\r\nexport default class  DetailsReviews extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            aReviews:[],\r\n            iReviewTotal:0,\r\n            gid:props.location.search!==\"\"?localParam(props.location.search).search.gid:\"\",\r\n        };\r\n        this.oUpRefresh=null;\r\n        this.curPage=1;\r\n        this.maxPage=0;\r\n        this.offsetBottom=100;\r\n        \r\n    }\r\n    componentDidMount(){\r\n        this.getReviews();\r\n    }\r\n    UNSAFE_componentWillReceiveProps(){\r\n       \r\n    }\r\n    componentWillUnmount(){\r\n        this.setState=(state,callback)=>{\r\n            return;\r\n        }\r\n    }\r\n   \r\n    //获取商品评价信息\r\n    getReviews(){\r\n        let sUrl=config.baseUrl+\"/api/home/reviews/index?gid=\"+this.state.gid+\"&token=\"+config.token+\"&page=1\";\r\n        request(sUrl).then((res)=>{\r\n            if(res.code===200){\r\n                this.setState({aReviews:res.data,iReviewTotal:res.pageinfo.total},()=>{\r\n                    lazyImg();\r\n                })\r\n                this.maxPage=res.pageinfo.pagenum;\r\n                this.getScrollPage();\r\n            }else{\r\n                this.setState({aReviews:[]})\r\n            }\r\n        });\r\n    }\r\n\r\n    //向下滑动刷新商品列表\r\n    getScrollPage(){\r\n        this.oUpRefresh=new UpRefresh({\"curPage\":this.curPage,\"maxPage\":this.maxPage,\"offsetBottom\":this.offsetBottom},curPage=>{\r\n            let sUrl=config.baseUrl+\"/api/home/reviews/index?gid=\"+this.state.gid+\"&token=\"+config.token+\"&page=\"+this.curPage;\r\n            request(sUrl).then((res)=>{\r\n                if (res.code===200){\r\n                    if (res.data.length>0){\r\n                        let aReviews=this.state.aReviews;\r\n                        for (let i=0;i<res.data.length;i++){\r\n                            aReviews.push(res.data[i]);\r\n                        }\r\n                        this.setState({aReviews:aReviews},()=>{\r\n                            lazyImg();\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        });\r\n       \r\n    }\r\n    render(){\r\n        return(\r\n            <div>\r\n                <div className={Css[\"page\"]}>\r\n                    <div className={Css[\"reviews-main\"]}>\r\n                        <div className={Css[\"reviews-title\"]}>商品评价({this.state.iReviewTotal})</div>\r\n                        <div className={Css[\"reviews-wrap\"]}>\r\n                        {\r\n                            this.state.aReviews.length>0?\r\n                                this.state.aReviews.map((item,index)=>{\r\n                                    return (\r\n                                        <div key={index} className={Css[\"reviews-list\"]}>\r\n                                            <div className={Css[\"uinfo\"]}>\r\n                                                <div className={Css[\"head\"]}>\r\n                                                    <img alt={item.nickname} data-echo={item.head}\r\n                                                    src={require(\"../../../assets/images/common/lazyImg.jpg\")}></img>\r\n                                                </div>\r\n                                                <div className={Css[\"nickname\"]}>{item.nickname}</div>\r\n                                            </div>\r\n                                            <div className={Css[\"reviews-content\"]}>{item.content}</div>\r\n                                            <div className={Css[\"reviews-date\"]}>{item.times}</div>\r\n                                        </div>\r\n                                    )\r\n\r\n                                })\r\n                            :<div className=\"null-item\">没有相关评价！</div>\r\n                        }\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"_2DiAwnaG3KXP4BSRavvOtv\",\"reviews-main\":\"_1CG_rIqSZ24_rc_Hw99x3i\",\"reviews-title\":\"_2TXAVp-W24gpU_pGhg7IhJ\",\"reviews-wrap\":\"_1umTLXa8kgv0n6bo1AASYv\",\"reviews-list\":\"_2xpD_8rWtuzTGK0PesAQ-4\",\"uinfo\":\"_2OapEDwCbI1Q4RHj3tJCpz\",\"head\":\"_2ZFuIOuKjOoLqva7-2FBqP\",\"nickname\":\"j9K4s2VbwI7K1ACDyGYCz\",\"reviews-content\":\"_13Dt5f_Jm56OXyg8VC5G6e\",\"reviews-date\":\"_2ZJZyS_qmIGh7ToOqjkkv1\",\"reviews-more\":\"p8IQWADpv3qtypNU4QBil\"};"],"sourceRoot":""}
(this["webpackJsonpreact-test"]=this["webpackJsonpreact-test"]||[]).push([[31],{400:function(e,t,a){e.exports=a.p+"static/media/lazyImg.639beef7.jpg"},403:function(e,t,a){var i,s=function(e,t){e instanceof Object&&(this.opts=e,this.iMaxPage=this.opts.maxPage,this.fnCallback=t,this.iOffsetBottom=this.opts.offsetBottom,this.iCurPage=this.opts.curPage,this.init())};s.prototype={init:function(){this.eventScroll()},eventScroll:function(){window.addEventListener("scroll",this.scrollBottom())},scrollBottom:function(){var e=this,t=!0;return function(){t&&(t=!1,setTimeout((function(){var a=document.documentElement.offsetHeight||document.body.offsetHeight,i=document.documentElement.scrollTop||document.body.scrollTop;a-((document.documentElement.clientHeight||document.body.clientHeight)+i)<=e.iOffsetBottom&&e.iCurPage<e.iMaxPage&&(e.iCurPage++,e.fnCallback(e.iCurPage)),t=!0}),100))}}},e.exports?e.exports=s:void 0===(i=function(){return s}.call(t,a,t,e))||(e.exports=i)},516:function(e,t,a){e.exports={page:"J81MzK3inZ48nyfth0MSJ",hide:"_3DxKIGu0iAFH4WEJph5fd7","search-top":"_24HPE1STZ8UEELh6k0Bppe","search-head":"_1qBS86vegcUw0vVyX9mgd0",back:"_1m4yh5A0njQlYxHTB5nIFw","search-wrap":"_2ULI8tox8oV_O3rahRL7Qb","search-icon":"_1s1BpXGo3OO2nNlhOh8nCn","search-text":"TFY_mWNFlCgjhdlhvObqQ","screen-btn":"_1GtexGew01A3pXluPdXP2p","order-main":"_2Cjf43MbpjzBhiY9vjGIJS","order-item":"_3cNQ5a0PpXeMzuAtYQnGmZ",active:"_3sVnxZHCnlalLIFpj_FGMS","order-text":"JHQzo20wg6pv7e84GZIkn","order-icon-up":"_2C23lghINXM7N9h8mBT2pl","order-icon":"_1wvzi_47n6BfX2hVAYcPgt","order-menu":"_1Lx21Y_Ae_P4aBIHNR6iXD","goods-main":"_1kzlDGl0RixnVgH4NxL7NZ","goods-list":"_3J66OgBO8nG7828-aIy0AI",image:"_1Df8Vtv5I95fXIDvQN4Zik","goods-content":"_25_lF4Vt1azR4GuTEji3EG","goods-title":"_2sb7ZyuvoeGF0LF1WGfjQi","goods-price":"_3T4b-n5oMtuS_0B4l9StZ4","goods-sales":"_1LjR6eb_6LXL8W_c3FffuD",mask:"_2AouHnRIrUh5Flh3jzurHJ",screen:"_3XnlZBuEvvG5s9H5Z_tlqu",move:"XxHdl1MaPr-hQPbpUzMhL",unmove:"_1W_V72mpAuwFbD5jGvHmZ_","attr-wrap":"_3P7PRIv6RT7aX-KcpRlmCg","attr-title-wrap":"_3RJoti7xBEs15Oei4muAtL","attr-name":"_3AQ7DSVjySZmPfa-A3aEqv","price-wrap":"_5PfRRTQUSdM-pBwT_WXHZ","price-input":"deZT58cuZ6MoMOHzP2qWx","price-line":"_2UrvcdylEkcdMYrsoFstTr","attr-icon-down":"_2y264HXWac7IfxgXI_iXxR","attr-icon-up":"_3j7Nziq9bXB7LX7dGv8qmx","item-wrap":"_1G26rvf0UMWAh4g72ywxXD",item:"_1-gE22iBFJCK-FCnXxUnF","handle-wrap":"_2ID1RU_FEgpAkKmr1jaPKD",reset:"_1OOg1jaJfynZ0ACfVCCsWB",sure:"_2_ngf5laggF7YC__sKb1c9"}},577:function(e,t,a){"use strict";a.r(t),a.d(t,"default",(function(){return P}));var i=a(52),s=a(53),c=a(55),r=a(54),n=a(1),l=a.n(n),h=a(7),o=a(382),d=a(426),m=a.n(d),u=a(386),f=a(427),p=a(516),v=a.n(p),g=a(403),k=a.n(g),P=function(e){Object(c.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={screenMove:"",bMask:!1,bPriceMenu:!1,bSalesMenu:!1,pageStyle:{display:"none"},aGoods:[],aPriceOrder:[{title:"\u7efc\u5408",type:"all",checked:!0},{title:"\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8",type:"up",checked:!1},{title:"\u4ef7\u683c\u4ece\u9ad8\u5230\u4f4e",type:"down",checked:!1}],sKeywords:"",itemTotal:0,aClassify:{checked:!0,items:[]},aPrice:{checked:!0,items:[{price1:1,price2:50,checked:!1},{price1:51,price2:99,checked:!1},{price1:100,price2:300,checked:!1},{price1:301,price2:1e3,checked:!1},{price1:1001,price2:4e3,checked:!1},{price1:4001,price2:9999,checked:!1}]},fPrice1:0,fPrice2:0,aAttr:[]},a.myScroll=null,a.oUpRefresh=null,a.curPage=1,a.maxPage=0,a.offsetBottom=100,a.bPriceMenu=!1,a.bSalesMenu=!1,a.oType="all",a.sParams="",a.sKeywords="",a.cid="",a.fPrice1="",a.fPrice2="",a.sParam="",a.aParam=[],a.cid="",a}return Object(s.a)(n,[{key:"componentDidMount",value:function(){this.myScroll=new m.a(this.refs.screen,{scrollX:!1,scrollY:!0,preventDefault:!1}),this.sKeywords=decodeURIComponent(Object(u.b)(this.props.location.search).search.keywords),this.setState({sKeywords:this.sKeywords}),this.getPageData(),this.getClassifyData(),this.getAttrData()}},{key:"componentWillUnmount",value:function(){this.setState=function(e,t){}}},{key:"showScreen",value:function(){this.refs.mask.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),this.refs.screen.addEventListener("touchmove",(function(e){e.preventDefault()}),!1),this.setState({screenMove:v.a.move,bMask:!0})}},{key:"hideScreen",value:function(){this.setState({screenMove:v.a.unmove,bMask:!1})}},{key:"goBack",value:function(){this.props.history.goBack()}},{key:"handlePriceOrder",value:function(){this.bPriceMenu?(this.bPriceMenu=!1,this.setState({bPriceMenu:!1})):(this.bPriceMenu=!0,this.setState({bPriceMenu:!0})),this.bSalesMenu=!1,this.setState({bSalesMenu:!1})}},{key:"handleSalesOrder",value:function(){this.bSalesMenu||(this.bSalesMenu=!0,this.setState({bSalesMenu:!0})),this.bPriceMenu=!1,this.setState({bPriceMenu:!1}),this.oType="sales",this.getPageData()}},{key:"getStyle",value:function(e){this.setState({pageStyle:e})}},{key:"getPageData",value:function(){var e=this;this.setParams();var t=h.a.baseUrl+"/api/home/goods/search?"+this.sParams+"&page=1&token="+h.a.token;Object(o.a)(t).then((function(t){200===t.code?(e.setState({aGoods:t.data,itemTotal:t.pageinfo.total},(function(){Object(u.a)()})),e.maxPage=t.pageinfo.pagenum,e.getScrollPage()):e.setState({aGoods:[],itemTotal:0})}))}},{key:"getScrollPage",value:function(){var e=this;this.oUpRefresh=new k.a({curPage:this.curPage,maxPage:this.maxPage,offsetBottom:this.offsetBottom},(function(t){var a=h.a.baseUrl+"/api/home/goods/search?"+e.sParams+"&page="+t+"&token="+h.a.token;Object(o.a)(a).then((function(t){if(200===t.code&&t.data.length>0){for(var a=e.state.aGoods,i=0;i<t.data.length;i++)a.push(t.data[i]);e.setState({aGoods:a},(function(){Object(u.a)()}))}}))}))}},{key:"setParams",value:function(){this.sParams="kwords="+this.sKeywords+"&param="+this.sParam+"&price1="+this.fPrice1+"&price2="+this.fPrice2+"&otype="+this.oType+"&cid="+this.cid}},{key:"checkedPriceOrder",value:function(e){for(var t=this.state.aPriceOrder,a=0;a<t.length;a++)t[a].checked=!1;t[e].checked=!0,this.setState({aPriceOrder:t}),this.oType=t[e].type,this.getPageData()}},{key:"getChildKeywords",value:function(e){this.sKeywords=e,this.setState({sKeywords:e,pageStyle:{display:"none"}}),this.props.history.replace(h.a.path+"goods/search?keywords="+e),this.setReset(),this.getPageData(),this.getAttrData()}},{key:"handleClassify",value:function(){var e=this.state.aClassify;e.checked?e.checked=!1:e.checked=!0,this.setState({aClassify:e})}},{key:"checkedClassify",value:function(e){var t=this.state.aClassify;if(t.items.length>0){for(var a=0;a<t.items.length;a++)a!==e&&(t.items[a].checked=!1);t.items[e].checked?(t.items[e].checked=!1,this.cid=""):(t.items[e].checked=!0,this.cid=t.items[e].cid),this.setState({aClassify:t})}}},{key:"handlePrice",value:function(){var e=this.state.aPrice;e.checked?e.checked=!1:e.checked=!0,this.setState({aPrice:e})}},{key:"checkedPrice",value:function(e,t,a){var i=this.state.aPrice;if(i.items.length>0){for(var s=0;s<i.items.length;s++)s!==e&&(i.items[s].checked=!1);i.items[e].checked?(i.items[e].checked=!1,t=0,a=0,this.fPrice1="",this.fPrice2=""):(i.items[e].checked=!0,this.fPrice1=t,this.fPrice2=a),this.setState({aPrice:i,fPrice1:t,fPrice2:a})}}},{key:"preventBubble",value:function(e){e.stopPropagation()}},{key:"changePrice1",value:function(e){var t=this;this.setState({fPrice1:e.target.value.replace(/[a-zA-Z]|[\u4e00-\u9fa5]|[#|*|,|+|;]/g,"")},(function(){t.fPrice1=t.state.fPrice1}))}},{key:"changePrice2",value:function(e){var t=this;this.setState({fPrice2:e.target.value.replace(/[a-zA-Z]|[\u4e00-\u9fa5]|[#|*|,|+|;]/g,"")},(function(){t.fPrice2=t.state.fPrice2}))}},{key:"handleAttr",value:function(e){var t=this.state.aAttr;t[e].checked?t[e].checked=!1:t[e].checked=!0,this.setState({aAttr:t})}},{key:"checkedParams",value:function(e,t){var a=this.state.aAttr;if(a[e].param[t].checked){a[e].param[t].checked=!1;for(var i=0;i<this.aParam.length;i++)if(this.aParam[i]===a[e].param[t].pid){this.aParam.splice(i--,1);break}}else a[e].param[t].checked=!0,this.aParam.push(a[e].param[t].pid);this.sParam=this.aParam.length>0?JSON.stringify(this.aParam):"",this.setState({aAttr:a})}},{key:"getClassifyData",value:function(){var e=this,t=h.a.baseUrl+"/api/home/category/menu?token="+h.a.token;Object(o.a)(t).then((function(t){if(200===t.code){var a=e.state.aClassify;a.items=t.data;for(var i=0;i<t.data.length;i++)a.items[i].checked=!1;e.setState({aClassify:a},(function(){e.myScroll.refresh()}))}}))}},{key:"getAttrData",value:function(){var e=this,t=h.a.baseUrl+"/api/home/goods/param?kwords="+this.sKeywords+"&token="+h.a.token;Object(o.a)(t).then((function(t){if(200===t.code){for(var a=t.data,i=0;i<a.length;i++)if(a[i].checked=!0,a[i].param.length>0)for(var s=0;s<a[i].param.length;s++)a[i].param[s].checked=!1;e.setState({aAttr:a},(function(){e.myScroll.refresh()}))}}))}},{key:"goSearch",value:function(){this.hideScreen(),this.getPageData()}},{key:"setReset",value:function(){this.sParam="",this.aParam=[],this.cid="",this.fPrice1="",this.fPrice2="",this.oType="all";var e=this.state.aClassify;if(e.items.length>0)for(var t=0;t<e.items.length;t++)e.items[t].checked=!1;for(var a=this.state.aPrice,i=0;i<a.items.length;i++)a.items[i].checked=!1;var s=this.state.aAttr;if(s.length>0)for(var c=0;c<s.length;c++)if(s[c].param.length>0)for(var r=0;r<s[c].param.length;r++)s[c].param[r].checked=!1;this.setState({fPrice1:0,fPrice2:0,aClassify:e,aPrice:a,aAttr:s})}},{key:"pushPage",value:function(e){this.props.history.push(h.a.path+e)}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:v.a.page},l.a.createElement("div",{className:v.a["search-top"]},l.a.createElement("div",{className:v.a["search-head"]},l.a.createElement("div",{className:v.a.back,onClick:this.goBack.bind(this)}),l.a.createElement("div",{className:v.a["search-wrap"],onClick:this.getStyle.bind(this,{display:"block"})},l.a.createElement("div",{className:v.a["search-icon"]}),l.a.createElement("div",{className:v.a["search-text"]},"\u8f93\u5165\u5b9d\u8d1d\u540d\u79f0")),l.a.createElement("div",{className:v.a["screen-btn"],onClick:this.showScreen.bind(this)},"\u7b5b\u9009")),l.a.createElement("div",{className:v.a["order-main"]},l.a.createElement("div",{className:this.state.bPriceMenu?v.a["order-item"]+" "+v.a.active:v.a["order-item"],onClick:this.handlePriceOrder.bind(this)},l.a.createElement("div",{className:v.a["order-text"]},"\u7efc\u5408"),l.a.createElement("div",{className:v.a["order-icon"]}),l.a.createElement("ul",{className:this.state.bPriceMenu?v.a["order-menu"]:v.a["order-menu"]+" "+v.a.hide},this.state.aPriceOrder.map((function(t,a){return l.a.createElement("li",{key:a,className:t.checked?v.a.active:"",onClick:e.checkedPriceOrder.bind(e,a)},t.title)})))),l.a.createElement("div",{className:this.state.bSalesMenu?v.a["order-item"]+" "+v.a.active:v.a["order-item"],onClick:this.handleSalesOrder.bind(this)},l.a.createElement("div",{className:v.a["order-text"]},"\u9500\u91cf")))),l.a.createElement("div",{className:v.a["goods-main"]},this.state.aGoods.length>0?this.state.aGoods.map((function(t,i){return l.a.createElement("div",{key:i,className:v.a["goods-list"],onClick:e.pushPage.bind(e,"goods/details/item?gid="+t.gid)},l.a.createElement("div",{className:v.a.image},l.a.createElement("img",{"data-echo":t.image,src:a(400),alt:t.title})),l.a.createElement("div",{className:v.a["goods-content"]},l.a.createElement("div",{className:v.a["goods-title"]},t.title),l.a.createElement("div",{className:v.a["goods-price"]},"\xa5",t.price),l.a.createElement("div",{className:v.a["goods-sales"]},"\u9500\u91cf",l.a.createElement("span",null,t.sales),"\u4ef6")))})):l.a.createElement("div",{className:"null-item"},"\u6ca1\u6709\u76f8\u5173\u5546\u54c1!")),l.a.createElement("div",{ref:"mask",className:this.state.bMask?v.a.mask:v.a.mask+" "+v.a.hide,onClick:this.hideScreen.bind(this)}),l.a.createElement("div",{ref:"screen",className:v.a.screen+" "+this.state.screenMove},l.a.createElement("div",null,l.a.createElement("div",{className:v.a["attr-wrap"]},l.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:this.handleClassify.bind(this)},l.a.createElement("div",{className:v.a["attr-name"]},"\u5206\u7c7b"),l.a.createElement("div",{className:this.state.aClassify.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),l.a.createElement("div",{className:this.state.aClassify.checked?v.a["item-wrap"]:v.a["item-wrap"]+"height-hide"},this.state.aClassify.items.length>0?this.state.aClassify.items.map((function(t,a){return l.a.createElement("div",{key:a,className:t.checked?v.a.item+" "+v.a.active:v.a.item,onClick:e.checkedClassify.bind(e,a)},t.title)})):""),l.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:this.handlePrice.bind(this)},l.a.createElement("div",{className:v.a["attr-name"]},"\u4ef7\u683c\u533a\u95f4"),l.a.createElement("div",{className:v.a["price-wrap"]},l.a.createElement("div",{className:v.a["price-input"],onClick:this.preventBubble.bind(this)},l.a.createElement("input",{type:"tel",placeholder:"\u6700\u4f4e\u4ef7",value:0===this.state.fPrice1?"":this.state.fPrice1,onChange:this.changePrice1.bind(this)})),l.a.createElement("div",{className:v.a["price-line"]}),l.a.createElement("div",{className:v.a["price-input"],onClick:this.preventBubble.bind(this)},l.a.createElement("input",{type:"tel",placeholder:"\u6700\u9ad8\u4ef7",value:0===this.state.fPrice2?"":this.state.fPrice2,onChange:this.changePrice2.bind(this)}))),l.a.createElement("div",{className:this.state.aPrice.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),l.a.createElement("div",{className:this.state.aPrice.checked?v.a["item-wrap"]:v.a["item-wrap"]+"height-hide"},this.state.aPrice.items.map((function(t,a){return l.a.createElement("div",{onClick:e.checkedPrice.bind(e,a,t.price1,t.price2),key:a,className:t.checked?v.a.item+" "+v.a.active:v.a.item},t.price1,"-",t.price2)}))),l.a.createElement("div",{style:{width:"100%",height:"0.9rem",backgroundColor:"#efefef"}}),this.state.aAttr.length>0?this.state.aAttr.map((function(t,a){return l.a.createElement(l.a.Fragment,{key:a},l.a.createElement("div",{className:v.a["attr-title-wrap"],onClick:e.handleAttr.bind(e,a)},l.a.createElement("div",{className:v.a["attr-name"]},t.title),l.a.createElement("div",{className:t.checked?v.a["attr-icon-down"]:v.a["attr-icon-up"]})),l.a.createElement("div",{className:t.checked?v.a["item-wrap"]:v.a["item-wrap"]+"height-hide"},t.param.length>0?t.param.map((function(t,i){return l.a.createElement("div",{key:i,className:t.checked?v.a.item+" "+v.a.active:v.a.item,onClick:e.checkedParams.bind(e,a,i)},t.title)})):""))})):""),l.a.createElement("div",{style:{width:"100%",height:"2%",backgroundColor:"#efefef"}}),l.a.createElement("div",{style:{width:"100%",height:"2.5rem",backgroundColor:"#ffffff"}})),l.a.createElement("div",{className:v.a["handle-wrap"]},l.a.createElement("div",{className:v.a.item},"\u5171",l.a.createElement("span",null,this.state.itemTotal),"\u4ef6"),l.a.createElement("div",{className:v.a.item+" "+v.a.reset,onClick:this.setReset.bind(this)},"\u5168\u90e8\u91cd\u7f6e"),l.a.createElement("div",{className:v.a.item+" "+v.a.sure,onClick:this.goSearch.bind(this)},"\u786e\u5b9a"))),l.a.createElement(f.a,{pageStyle:this.state.pageStyle,childStyle:this.getStyle.bind(this),isLocal:"1",childKeywords:this.getChildKeywords.bind(this),keywords:this.state.sKeywords}))}}]),n}(l.a.Component)}}]);
//# sourceMappingURL=31.e5e8505f.chunk.js.map
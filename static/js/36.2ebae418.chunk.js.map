{"version":3,"sources":["assets/css/home/goods/classify.module.css","pages/home/goods/classify.js"],"names":["module","exports","GoodsItems","asyncComponents","GoodsClassify","props","state","aClassify","pageStyle","display","myScroll","aTempClassify","cid","location","search","localParam","this","getClassifyData","setState","callback","pUrl","history","replace","config","path","goBack","scrollClassify","refs","addEventListener","e","preventDefault","passive","IScroll","scrollX","scrollY","request","baseUrl","token","then","res","code","data","i","length","bActive","eventScroll","defaultClassifyStyle","pIndex","handleScroll","replacePage","oScrollClassify","iTopHeight","Math","round","parseInt","offsetHeight","iHalfHeight","iBottomHeight","scrollHeight","scrollTo","utils","ease","elastic","val","className","Css","onClick","bind","changeSearch","ref","map","item","index","key","changeStyle","title","component","childStyle","getStyle","React","Component"],"mappings":"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","file":"static/js/36.2ebae418.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"search-header\":\"_2Yerq-ohlRA-FmFdy5ehsq\",\"back\":\"_2_GQN1VrFr7WzckkhZAtQz\",\"search\":\"_12V2o5-YeB9eTdZeD-2OK4\",\"goods-main\":\"_39O8zwtdOO4Kl48s7Jbbmj\",\"classify-wrap\":\"_3nGtG0XqH-nNJoKid0pEKS\",\"classify-item\":\"_2W0HTi9fbek5ii0s2By7o0\",\"active\":\"XPe4t7WnlCESWlWwdvFzn\",\"goods-content\":\"_3Vias5K-TulUOuh8KgR69V\"};","import React from 'react';\nimport  {Route,Switch}  from  'react-router-dom';\nimport asyncComponents from '../../../components/async/AsyncComponent';\nimport config from '../../../assets/js/conf/config.js';\nimport IScroll from '../../../assets/js/libs/iscroll.js';\nimport Css from '../../../assets/css/home/goods/classify.module.css';\nimport {request} from \"../../../assets/js/libs/request\";\nimport {localParam} from \"../../../assets/js/utils/util\";\nimport SearchComponent from '../../../components/search/search';\nconst GoodsItems=asyncComponents(()=>import('./items'));\nexport default class  GoodsClassify extends React.Component{\n    constructor(props){\n        super(props);\n        this.state={\n            aClassify:[],\n            pageStyle:{display:\"none\"}\n        };\n        this.myScroll=null;\n        this.aTempClassify=[];\n        this.cid=props.location.search?localParam(props.location.search).search.cid:'492';\n    }\n    componentDidMount(){\n        this.getClassifyData();\n    }\n    componentWillUnmount(){\n        this.setState=(state,callback)=>{\n            return;\n        }\n    }\n    replacePage(pUrl){\n      this.props.history.replace(config.path+pUrl);\n    }\n    goBack(){\n        this.props.history.goBack();\n    }\n    eventScroll(){\n        let scrollClassify=this.refs['scroll-classify'];\n        scrollClassify.addEventListener('touchmove', function (e) { e.preventDefault(); },  {passive: false});\n        this.myScroll= new IScroll(scrollClassify, {\n            scrollX : false,\n            scrollY : true,\n            preventDefault : false\n        });\n    }\n    getClassifyData(){\n        request(config.baseUrl+\"/api/home/category/menu?token=\"+config.token).then(res =>{\n            if (res.code ===200){\n                this.aTempClassify=res.data;\n                for (let i=0;i<this.aTempClassify.length;i++){\n                    this.aTempClassify[i].bActive=false;\n                }\n                this.setState({aClassify:this.aTempClassify},()=>{\n                    this.eventScroll();\n                    this.defaultClassifyStyle();\n                })\n            }\n        } );\n    }\n    changeStyle(pUrl,pIndex){\n        if (this.aTempClassify.length>0){\n            for (let i=0;i<this.aTempClassify.length;i++){\n                this.aTempClassify[i].bActive=false;\n            }\n        }\n        this.aTempClassify[pIndex].bActive=true;\n        this.setState({aClassify:this.aTempClassify}); \n        this.handleScroll(pIndex);\n        this.replacePage(pUrl);\n    }\n    handleScroll(pIndex){\n        let oScrollClassify=this.refs['scroll-classify'];\n        let iTopHeight=Math.round(parseInt(this.refs['item-'+pIndex].offsetHeight)*pIndex);\n        let iHalfHeight=Math.round(oScrollClassify.offsetHeight/3);\n        let iBottomHeight=oScrollClassify.scrollHeight-iTopHeight;\n        if (iTopHeight>iHalfHeight && iBottomHeight>oScrollClassify.offsetHeight){\n            this.myScroll.scrollTo(0,-iTopHeight,300,IScroll.utils.ease.elastic);\n        }\n    }\n    defaultClassifyStyle(){\n        if (this.aTempClassify.length>0){\n            for (let i=0;i<this.aTempClassify.length;i++){\n                if (this.aTempClassify[i].cid ===this.cid){\n                    this.aTempClassify[i].bActive=true;\n                    break;\n                }\n            }\n            this.replacePage('goods/classify/items?cid='+this.cid+'');\n            this.setState({aClassify:this.aTempClassify});\n        }\n    }\n    getStyle(val){\n        this.setState({\n            /* pageStyle:{'display':'none'} */\n            pageStyle:val\n        })\n    }\n    changeSearch(){\n        this.setState({pageStyle:{display:\"block\"}})\n    }\n    render(){\n        return(\n            <div>\n                <div className={Css['search-header']}>\n                    <div className={Css['back']} onClick={this.goBack.bind(this)}></div>\n                    <div className={Css['search']} onClick={this.changeSearch.bind(this)}>请输入宝贝名称</div>\n                </div>\n                <div className={Css['goods-main']}>\n                    <div ref=\"scroll-classify\" className={Css['classify-wrap']}>\n                        <div>\n                            {\n                                this.state.aClassify!=null?\n                                    this.state.aClassify.map((item, index)=>{\n                                        return(\n                                            <div ref={\"item-\"+index} className={item.bActive?Css['classify-item']+\" \"+Css['active']:Css['classify-item']} key={index} onClick={this.changeStyle.bind(this, 'goods/classify/items?cid='+item.cid+'',index)}>{item.title}</div>\n                                        )\n                                    })\n                                :\"\"\n                            }\n                        </div>\n                    </div>\n                    <div className={Css['goods-content']}>\n                        <Switch>\n                            <Route path={config.path+\"goods/classify/items\"} component={GoodsItems}></Route>\n                        </Switch>\n                    </div>\n                </div>\n                <SearchComponent pageStyle={this.state.pageStyle} childStyle={this.getStyle.bind(this)}></SearchComponent>\n            </div>\n        );\n    }\n}"],"sourceRoot":""}
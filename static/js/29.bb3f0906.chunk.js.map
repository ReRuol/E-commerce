{"version":3,"sources":["assets/js/libs/request.js","components/header/subHeader.js","components/header/subHeader.module.css","assets/css/home/reg/index.module.css","pages/home/reg/index.js"],"names":["oLoad","ReactDOM","findDOMNode","document","getElementById","request","pUrl","pType","toLocaleLowerCase","data","showLoad","config","headers","params","Object","key","FormData","append","method","body","encodeURIComponent","slice","fetch","then","res","hideLoad","json","style","display","SubHeader","this","props","location","pathname","path","history","replace","goBack","className","Css","onClick","bind","title","getClick","React","Component","withRouter","module","exports","RegIndex","state","SwitchChecked","sCellphone","bCodeSuccess","sCodeText","sCode","sPassword","timer","bSendCode","bSubmit","innerHTML","clearInterval","setState","callback","e","target","value","match","isSameCellphone","resData","code","isreg","info","iTime","setInterval","sUrl","baseUrl","token","vcode","cellphone","password","username","type","placeholder","onChange","checkCellphone","getCode","autoComplete","checked","submitData"],"mappings":"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","file":"static/js/29.bb3f0906.chunk.js","sourcesContent":["import ReactDOM from 'react-dom';\nimport {fetch} from 'whatwg-fetch';\nlet oLoad=ReactDOM.findDOMNode(document.getElementById(\"page-load\"));\nfunction request(pUrl,pType='get'.toLocaleLowerCase(),data={}){\n    showLoad();\n    let config={},headers={},params='';\n    if(pType===\"file\".toLocaleLowerCase()){\n        pType=\"post\";\n        if(data instanceof Object){\n            params=new FormData();\n            for(let key in data){\n                params.append(key,data[key]);\n            }\n        }\n        config={\n            method:pType,\n            body:params\n        }\n    }\n    else if (pType ===\"get\".toLocaleLowerCase()){\n        config = {\n            method: pType\n        }\n    }else{\n        headers = {\n            'Content-Type':'application/x-www-form-urlencoded'\n        }\n        if (data instanceof Object){\n            for (let key in data){\n                params+=`&${key}=${encodeURIComponent(data[key])}`;\n            }\n            params = params.slice(1)\n        }\n        config = {\n            method: pType,\n            headers,\n            body:params\n        }\n    }\n    return fetch(pUrl,config).then(res=> {\n            hideLoad();\n            return res.json();\n        }\n    );\n}\nfunction showLoad(){\n    oLoad.style.display=\"block\";\n}\nfunction hideLoad(){\n    oLoad.style.display=\"none\";\n}\nexport {\n    request\n};","import React from 'react';\r\nimport {withRouter} from \"react-router\";\r\nimport config from '../../assets/js/conf/config';\r\nimport Css from './subHeader.module.css';\r\nclass  SubHeader extends React.Component{\r\n    componentDidMount(){\r\n   \r\n    }\r\n    goBack(){\r\n        if(this.props.location.pathname===config.path+\"address/index\"){\r\n            this.props.history.replace(config.path+\"balance/index\")\r\n        }else{\r\n            this.props.history.goBack();\r\n        }\r\n    }\r\n\r\n    //获取父组件的点击事件\r\n    getClick(){\r\n        this.props['onClickRightBtn']();\r\n    }   \r\n    render(){\r\n        return(\r\n            <div className={Css['sub-header']}>\r\n                <div className={Css[\"back\"]}  \r\n                    onClick={this.goBack.bind(this)}>\r\n                </div>\r\n                <div className={Css[\"title\"]}>{this.props.title}</div>\r\n                <div className={this.props[\"right-text\"]!==\"\"?Css[\"right-btn\"]:\"hide\"} onClick={this.getClick.bind(this)}>\r\n                    {this.props['right-text']}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default withRouter(SubHeader);","// extracted by mini-css-extract-plugin\nmodule.exports = {\"sub-header\":\"_1tYQSWE0eNM6Iu_B_jiJFD\",\"back\":\"_2Lzz8D_AeNWRjPyUrH2_S2\",\"title\":\"_1sWYJVYekCdrxBAi3kEm3p\",\"right-btn\":\"_1UbjrHkAJM5t8wjVZqephO\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"page\":\"ekfV-DVRdetYJmATxtNGY\",\"main\":\"_1fj4UzZ0i-7w4ftc0Zuv4r\",\"cellphone-wrap\":\"_1MLppQ8gq0Zp44MhoCKDDd\",\"cellphone\":\"xhfFZDLhkIBszt52Ou4Tj\",\"code-btn\":\"wOElCMjPJb4qgG6FV_yTJ\",\"success\":\"_2zwMJXj0UJ1L2gLRT6wP6-\",\"code-wrap\":\"_3HsjRmAD7Efhtt6lMwlrku\",\"password-wrap\":\"_1c_X3qSaMDVymDjcoluK3n\",\"password\":\"_1R2MW3MqRQFZSPe-eSg_cG\",\"switch-wrap\":\"_3pXajm1gRpKOFYlK7zwwUx\",\"sure-btn\":\"_2KYEMGbrXuov_a2xXdAbXg\"};","import React from 'react';\r\nimport SubHeaderComponent from \"../../../components/header/subHeader\";\r\nimport Css from \"../../../assets/css/home/reg/index.module.css\";\r\nimport {Switch,Toast} from \"antd-mobile\";\r\nimport config from '../../../assets/js/conf/config';\r\nimport { request } from '../../../assets/js/libs/request';\r\nexport default class  RegIndex extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state={\r\n            SwitchChecked:false,\r\n            sCellphone:\"\",\r\n            bCodeSuccess:false,\r\n            sCodeText:\"获取短信验证码\",\r\n            sCode:\"\",\r\n            sPassword:\"\",\r\n        }\r\n        this.timer=null;\r\n        this.bSendCode=true;\r\n        this.bSubmit=true;\r\n    }\r\n    componentDidMount(){\r\n        document.getElementById('title').innerHTML=\"会员注册\"\r\n    }\r\n    componentWillUnmount(){\r\n        clearInterval(this.timer);\r\n        this.setState=(state,callback)=>{\r\n            return;\r\n        }\r\n    }\r\n    //验证手机号\r\n    checkCellphone(e){\r\n        this.setState({sCellphone:e.target.value},()=>{\r\n            if(this.bSendCode){\r\n                if(this.state.sCellphone.match(/^1[0-9][0-9]{9}$/)){\r\n                    this.setState({bCodeSuccess:true})\r\n                }else{\r\n                    this.setState({bCodeSuccess:false})\r\n                }\r\n            }   \r\n        })\r\n    }\r\n\r\n    //获取短信验证码\r\n    async getCode(){\r\n        if(this.bSendCode && this.state.bCodeSuccess){\r\n            let resData=await this.isSameCellphone();\r\n            if(resData.code===200){\r\n                if(resData.data.isreg===\"1\"){\r\n                    Toast.info(\"该手机号已注册\",1.7);\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            let iTime=10;\r\n            this.setState({sCodeText:\"重新发送\"+iTime+\"s\",bCodeSuccess:false});\r\n            this.bSendCode=false;\r\n            this.timer=setInterval(()=>{\r\n                if(iTime>0){\r\n                    iTime--;\r\n                    this.setState({sCodeText:\"重新发送\"+iTime+\"s\"})\r\n                }else{\r\n                    this.bSendCode=true;\r\n                    clearInterval(this.timer);\r\n                    this.setState({sCodeText:\"获取短信验证码\"})\r\n                    this.setState({bCodeSuccess:true})\r\n                }\r\n            },1000)\r\n        }\r\n    }\r\n\r\n    //点击注册按钮提交数据\r\n    async submitData(){\r\n        if(this.state.sCellphone.match(/^\\s*$/)){\r\n            Toast.info(\"请输入您的手机号\",1.7);\r\n            return false;\r\n        }else if(!this.state.sCellphone.match(/^1[0-9][0-9]{9}/)){\r\n            Toast.info(\"请输入正确的手机号\",1.7);\r\n            return false;\r\n        }\r\n        let resData=await this.isSameCellphone();\r\n        if(resData.code===200){\r\n            if(resData.data.isreg===\"1\"){\r\n                Toast.info(\"该手机号已注册\",1.7);\r\n                return false;\r\n            }\r\n        }\r\n        if(this.state.sCode.match(/^\\s*$/)){\r\n            Toast.info(\"请输入短信验证码\",1.7);\r\n            return false;\r\n        }else if(this.state.sPassword.match(/^\\s*$/)){\r\n            Toast.info(\"请输入密码\",1.7);\r\n            return false;\r\n        }\r\n        let sUrl=config.baseUrl+\"api/home/user/reg?token=\"+config.token;\r\n\r\n        //使用this.bSubmit变量来避免多次点击按钮重复注册的问题\r\n        if(this.bSubmit){\r\n            this.bSubmit=false;\r\n            request(sUrl,\"post\",{vcode:this.state.sCode,cellphone:this.state.sCellphone,password:this.state.sPassword}).then(res=>{\r\n                if(res.code===200){\r\n                    this.props.history.goBack();\r\n                }\r\n            });\r\n        }\r\n        \r\n    }\r\n\r\n    //检测手机号是否注册过\r\n    isSameCellphone(){\r\n        let sUrl=config.baseUrl+\"api/home/user/isreg?token=\"+config.token;\r\n        return request(sUrl,\"post\",{username:this.state.sCellphone}).then(res=>{\r\n            return res;\r\n        });\r\n    }\r\n    render(){\r\n        return(\r\n            <div className={Css['page']}>  \r\n                <SubHeaderComponent title=\"会员注册\"></SubHeaderComponent>\r\n                <div className={Css[\"main\"]}>\r\n                    <div className={Css[\"cellphone-wrap\"]}>\r\n                        <div className={Css[\"cellphone\"]}>\r\n                            <input type=\"tel\" placeholder=\"请输入您的手机号\" onChange={(e)=>{this.checkCellphone(e)}}/>\r\n                        </div>\r\n                        <div className={this.state.bCodeSuccess?Css[\"code-btn\"]+\" \"+Css['success']:Css[\"code-btn\"]} \r\n                        onClick={this.getCode.bind(this)}>{this.state.sCodeText}\r\n                        </div>\r\n                    </div>\r\n                    <div className={Css[\"code-wrap\"]}>\r\n                        <input type=\"tel\" placeholder=\"请输入短信验证码\" onChange={(e)=>{\r\n                            this.setState({sCode:e.target.value})\r\n                        }}/>\r\n                    </div>\r\n                    <div className={Css[\"password-wrap\"]}>\r\n                        <div className={Css[\"password\"]}>\r\n                            <form >\r\n                                <input type={this.state.SwitchChecked?\"text\":\"password\"} placeholder=\"请输入密码\" autoComplete='tel' onChange={(e)=>{\r\n                                    this.setState({sPassword:e.target.value})\r\n                                }}/>\r\n                            </form>\r\n                        </div>\r\n                        <div className={Css[\"switch-wrap\"]}>\r\n                            <Switch checked={this.state.SwitchChecked} onChange={()=>{\r\n                                this.setState({SwitchChecked:!this.state.SwitchChecked})\r\n                            }}></Switch>\r\n                        </div>\r\n                    </div>\r\n                    <div className={Css[\"sure-btn\"]} onClick={this.submitData.bind(this)}>注册</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}"],"sourceRoot":""}
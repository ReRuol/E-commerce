{"version":3,"sources":["pages/user/address/mod.js"],"names":["AddressMod","props","safeAuth","state","defaultProvince","sProvince","sCity","sArea","sName","sCellphone","sAddress","bChecked","aid","localParam","location","search","this","getAddress","setState","callback","match","info","url","config","baseUrl","token","data","uid","user","name","cellphone","province","city","area","address","isdefault","request","then","res","sessionStorage","removeItem","code","history","goBack","sUrl","alert","text","onPress","style","localStorage","className","Css","title","right-text","onClickRightBtn","delData","bind","type","placeholder","value","onChange","e","target","onOk","join","undefined","readOnly","checked","onClick","submitData","React","Component","connect"],"mappings":"iUASOA,E,kDACH,WAAYC,GAAO,IAAD,6BACd,cAAMA,GACNC,YAASD,GACT,EAAKE,MAAM,CACPC,gBAAgB,GAChBC,UAAU,GACVC,MAAM,GACNC,MAAM,GACNC,MAAM,GACNC,WAAW,GACXC,SAAS,GACTC,UAAS,GAEb,EAAKC,IAAIC,YAAW,EAAKZ,MAAMa,SAASC,QAAQA,OAAOH,IAbzC,E,gEAgBdI,KAAKC,e,6CAGLD,KAAKE,SAAS,SAACf,EAAMgB,O,mCAMZ,IAAD,OACR,GAAGH,KAAKb,MAAMK,MAAMY,MAAM,SAEtB,OADA,IAAMC,KAAK,mDAAW,MACf,EACL,GAAGL,KAAKb,MAAMM,WAAWW,MAAM,SAEjC,OADA,IAAMC,KAAK,yDAAY,MAChB,EAEX,IAAIL,KAAKb,MAAMM,WAAWW,MAAM,oBAE5B,OADA,IAAMC,KAAK,qEAAc,MAClB,EAEX,GAAgC,KAA7BL,KAAKb,MAAMC,gBAEV,OADA,IAAMiB,KAAK,6CAAU,MACd,EAEX,GAAGL,KAAKb,MAAMO,SAASU,MAAM,SAEzB,OADA,IAAMC,KAAK,6CAAU,MACd,EAEX,IAAIC,EAAMC,IAAOC,QAAU,+BAA+BD,IAAOE,MAC7DC,EAAO,CACPd,IAAII,KAAKJ,IACTe,IAAIX,KAAKf,MAAME,MAAMyB,KAAKD,IAC1BE,KAAKb,KAAKb,MAAMK,MAChBsB,UAAUd,KAAKb,MAAMM,WACrBsB,SAASf,KAAKb,MAAME,UACpB2B,KAAKhB,KAAKb,MAAMG,MAChB2B,KAAKjB,KAAKb,MAAMI,MAChB2B,QAAQlB,KAAKb,MAAMO,SACnByB,UAAUnB,KAAKb,MAAMQ,SAAS,IAAI,KAEtCyB,YAAQd,EAAI,OAAOI,GAAMW,MAAK,SAACC,GACxB,EAAKnC,MAAMQ,UAEV4B,eAAeC,WAAW,aAEhB,MAAXF,EAAIG,MACH,IAAMpB,KAAK,4BAAQ,KAAK,WAEpB,EAAKpB,MAAMyC,QAAQC,iB,mCAQtB,IAAD,OACJC,EAAKrB,IAAOC,QAAQ,8BAA8BR,KAAKf,MAAME,MAAMyB,KAAKD,IAAI,QAAQX,KAAKJ,IAAI,UAAUW,IAAOE,MAClHW,YAAQQ,GAAMP,MAAK,SAACC,GACF,MAAXA,EAAIG,MACH,EAAKvB,SAAS,CAACV,MAAM8B,EAAIZ,KAAKG,KAAKpB,WAAW6B,EAAIZ,KAAKI,UAAUzB,UAAUiC,EAAIZ,KAAKK,SAChFzB,MAAMgC,EAAIZ,KAAKM,KAAKzB,MAAM+B,EAAIZ,KAAKO,KAAKvB,SAAS4B,EAAIZ,KAAKQ,QAAQvB,SAA8B,MAArB2B,EAAIZ,KAAKS,UACpF/B,gBAAgB,GAAD,OAAIkC,EAAIZ,KAAKK,SAAb,YAAyBO,EAAIZ,KAAKM,KAAlC,YAA0CM,EAAIZ,KAAKO,a,gCAMxE,IAAD,OACL,IAAMY,MAAM,GAAI,6CAAW,CACvB,CAAEC,KAAM,eAAMC,QAAS,aAAUC,MAAO,WACxC,CAAEF,KAAM,eAAMC,QAAS,WACnB,IAAIH,EAAKrB,IAAOC,QAAQ,6BAA6B,EAAKvB,MAAME,MAAMyB,KAAKD,IAAI,QAAQ,EAAKf,IAAI,UAAUW,IAAOE,MACjHW,YAAQQ,GAAMP,MAAK,SAACC,GACF,MAAXA,EAAIG,OACW,MAAXH,EAAIG,OACA,EAAK7B,MAAM2B,eAAc,WACxBA,eAAeC,WAAW,aAE3B,EAAK5B,MAAMqC,aAAY,WACtBA,aAAaT,WAAW,cAGhC,IAAMnB,KAAK,4BAAQ,KAAI,WACnB,EAAKpB,MAAMyC,QAAQC,sB,+BASlC,IAAD,OACJ,OACI,yBAAKO,UAAWC,IAAG,MACf,kBAAC,IAAD,CAAWC,MAAM,uCAASC,aAAW,eAAKC,gBAAiBtC,KAAKuC,QAAQC,KAAKxC,QAC7E,yBAAKkC,UAAWC,IAAG,MACf,4BACI,kDACA,4BAAI,2BAAOM,KAAK,OAAOC,YAAY,iCAAQC,MAAO3C,KAAKb,MAAMK,MAAOoD,SAAU,SAACC,GAC3E,EAAK3C,SAAS,CAACV,MAAMqD,EAAEC,OAAOH,aAGtC,4BACI,wDACA,4BAAI,2BAAOF,KAAK,OAAOC,YAAY,uCAASC,MAAO3C,KAAKb,MAAMM,WAAYmD,SAAU,SAACC,GACjF,EAAK3C,SAAS,CAACT,WAAWoD,EAAEC,OAAOH,aAG3C,4BACI,wDACA,4BACI,uBAAQjC,KAAMK,IAAUqB,MAAM,2BAAOW,KAAM,SAAAF,GACvC,EAAK3C,SAAS,CAACd,gBAAgByD,EAAEG,KAAK,KAAK3D,UAAUwD,EAAE,GAAGvD,MAAMuD,EAAE,GAAGtD,WAAa0D,IAAPJ,EAAE,GAAeA,EAAE,GAAG,OAIjG,2BAAOJ,KAAK,OAAOC,YAAY,6CAAUQ,UAAQ,EAACP,MAAO3C,KAAKb,MAAMC,gBAAiB8C,UAAWC,IAAG,UAK/G,4BACI,wDACA,4BAAI,2BAAOM,KAAK,OAAOC,YAAY,uCAASC,MAAO3C,KAAKb,MAAMO,SAAUkD,SAAU,SAACC,GAC/E,EAAK3C,SAAS,CAACR,SAASmD,EAAEC,OAAOH,aAEzC,4BACI,0EACA,4BAAI,2BAAOF,KAAK,WAAWP,UAAWC,IAAG,SAAcgB,QAASnD,KAAKb,MAAMQ,SAAUiD,SAAU,SAACC,GAC5F,EAAK3C,SAAS,CAACP,UAAU,EAAKR,MAAMQ,gBAI5C,4BAAQ8C,KAAK,SAASP,UAAWC,IAAI,eAAgBiB,QAASpD,KAAKqD,WAAWb,KAAKxC,OAAnF,sB,GAzJMsD,IAAMC,WA+JjBC,uBAAQ,SAACrE,GACpB,MAAO,CACHA,MAAMA,KAFCqE,CAIZxE","file":"static/js/41.fc75581f.chunk.js","sourcesContent":["import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport config from '../../../assets/js/conf/config';\r\nimport { request } from '../../../assets/js/libs/request';\r\nimport {safeAuth,localParam} from '../../../assets/js/utils/util.js';\r\nimport SubHeader from \"../../../components/header/subHeader\";\r\nimport Css from \"../../../assets/css/home/address/add.module.css\";\r\nimport {Picker ,Toast,Modal} from \"antd-mobile\";\r\nimport {province} from \"../../../assets/data/province\";\r\nclass  AddressMod extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        safeAuth(props);\r\n        this.state={\r\n            defaultProvince:'',\r\n            sProvince:\"\",\r\n            sCity:'',\r\n            sArea:'',\r\n            sName:'',\r\n            sCellphone:'',\r\n            sAddress:'',\r\n            bChecked:false,\r\n        }\r\n        this.aid=localParam(this.props.location.search).search.aid;\r\n    }\r\n    componentDidMount(){\r\n        this.getAddress();\r\n    }\r\n    componentWillUnmount(){\r\n        this.setState=(state,callback)=>{\r\n            return;\r\n        }\r\n    }\r\n\r\n    //提交数据到后台\r\n    submitData(){\r\n        if(this.state.sName.match(/^\\s*$/)){\r\n            Toast.info(\"请填写收货人姓名\",1.7)\r\n            return false\r\n        }else if(this.state.sCellphone.match(/^\\s*$/)){\r\n            Toast.info(\"请填写收货人手机号\",1.7)\r\n            return false\r\n        }\r\n        if(!this.state.sCellphone.match(/^1[0-9][0-9]{9}$/)){\r\n            Toast.info(\"您输入的手机号码不正确\",1.7)\r\n            return false\r\n        }\r\n        if(this.state.defaultProvince===''){\r\n            Toast.info(\"请填写所在地区\",1.7)\r\n            return false\r\n        }\r\n        if(this.state.sAddress.match(/^\\s*$/)){\r\n            Toast.info(\"请输入详细地址\",1.7)\r\n            return false\r\n        }\r\n        let url = config.baseUrl + \"/api/user/address/mod?token=\"+config.token;\r\n        let data = {\r\n            aid:this.aid,\r\n            uid:this.props.state.user.uid,\r\n            name:this.state.sName,\r\n            cellphone:this.state.sCellphone,\r\n            province:this.state.sProvince,\r\n            city:this.state.sCity,\r\n            area:this.state.sArea,\r\n            address:this.state.sAddress,\r\n            isdefault:this.state.bChecked?\"1\":\"0\"\r\n        }\r\n        request(url,\"post\",data).then((res)=>{\r\n            if(this.state.bChecked){\r\n                //localStorage['addressId']=this.aid;\r\n                sessionStorage.removeItem(\"addressId\");\r\n            }\r\n            if(res.code===200){\r\n                Toast.info(\"修改成功!\",1.7 ,()=>{\r\n                    //this.props.history.replace(config.path+\"address/index\")\r\n                    this.props.history.goBack();\r\n                })\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    //获取收货地址信息\r\n    getAddress(){\r\n        let sUrl=config.baseUrl+\"/api/user/address/info?uid=\"+this.props.state.user.uid+\"&aid=\"+this.aid+\"&token=\"+config.token;\r\n        request(sUrl).then((res)=>{\r\n            if(res.code===200){\r\n                this.setState({sName:res.data.name,sCellphone:res.data.cellphone,sProvince:res.data.province,\r\n                    sCity:res.data.city,sArea:res.data.area,sAddress:res.data.address,bChecked:res.data.isdefault===\"1\"?true:false,\r\n                    defaultProvince:`${res.data.province} ${res.data.city} ${res.data.area}`});\r\n            }\r\n        })\r\n    }\r\n\r\n    //删除收货地址\r\n    delData(){\r\n        Modal.alert('', '确认要删除吗？', [\r\n            { text: '取消', onPress: () => {}, style: 'default' },\r\n            { text: '确认', onPress: () => {\r\n                let sUrl=config.baseUrl+\"/api/user/address/del?uid=\"+this.props.state.user.uid+\"&aid=\"+this.aid+\"&token=\"+config.token;\r\n                request(sUrl).then((res)=>{\r\n                    if(res.code===200){\r\n                        if(res.code===200){\r\n                            if(this.aid===sessionStorage['addressId']){\r\n                                sessionStorage.removeItem(\"addressId\");\r\n                            }\r\n                            if(this.aid===localStorage['addressId']){\r\n                                localStorage.removeItem(\"addressId\");\r\n                            }\r\n                        }\r\n                        Toast.info(\"删除成功!\",1.5,()=>{\r\n                            this.props.history.goBack();\r\n                        })\r\n                    }\r\n                })\r\n            }\r\n                \r\n            }\r\n        ]);\r\n    }\r\n    render(){\r\n        return(\r\n            <div className={Css['page']}>\r\n                <SubHeader title=\"修改收货地址\" right-text=\"删除\" onClickRightBtn={this.delData.bind(this)}></SubHeader>\r\n                <div className={Css[\"main\"]}>\r\n                    <ul>\r\n                        <li>收货人</li>\r\n                        <li><input type=\"text\" placeholder=\"收货人姓名\" value={this.state.sName} onChange={(e)=>{\r\n                            this.setState({sName:e.target.value})\r\n                        }}/></li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>联系方式</li>\r\n                        <li><input type=\"text\" placeholder=\"联系人手机号\" value={this.state.sCellphone} onChange={(e)=>{\r\n                            this.setState({sCellphone:e.target.value})\r\n                        }}/></li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>所在地区</li>\r\n                        <li>\r\n                            <Picker data={province} title=\"选择地区\" onOk={e =>{\r\n                                this.setState({defaultProvince:e.join(\" \"),sProvince:e[0],sCity:e[1],sArea:e[2]!==undefined?e[2]:''})\r\n\r\n                            } } >\r\n\r\n                                <input type=\"text\" placeholder=\"请选择收货地址\" readOnly value={this.state.defaultProvince} className={Css['area']}/>\r\n                            </Picker> \r\n                        </li>\r\n                            \r\n                    </ul>\r\n                    <ul>\r\n                        <li>详细地址</li>\r\n                        <li><input type=\"text\" placeholder=\"街道详细地址\" value={this.state.sAddress} onChange={(e)=>{\r\n                            this.setState({sAddress:e.target.value})}}/></li>\r\n                    </ul>\r\n                    <ul>\r\n                        <li>设置为默认地址</li>\r\n                        <li><input type=\"checkbox\" className={Css['checkbox']} checked={this.state.bChecked} onChange={(e)=>{\r\n                            this.setState({bChecked:!this.state.bChecked})\r\n                        }}/></li>\r\n                    </ul>\r\n\r\n                    <button type=\"button\" className={Css['submit-save']} onClick={this.submitData.bind(this)}>保存</button>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\nexport default connect((state)=>{\r\n    return {\r\n        state:state\r\n    }\r\n})(AddressMod)"],"sourceRoot":""}
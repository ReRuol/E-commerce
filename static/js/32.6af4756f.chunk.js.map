{"version":3,"sources":["assets/images/common/lazyImg.jpg","assets/js/libs/uprefresh.js","assets/css/user/myorder/review.module.css","pages/user/myorder/review.js"],"names":["module","exports","UpRefresh","opts","callback","Object","this","iMaxPage","maxPage","fnCallback","iOffsetBottom","offsetBottom","iCurPage","curPage","init","prototype","eventScroll","window","addEventListener","scrollBottom","_this","bScroll","setTimeout","iScrollHeight","document","documentElement","offsetHeight","body","iScrollTop","scrollTop","clientHeight","define","OrderPage","props","safeAuth","state","aOrder","oUpRefresh","getData","setState","sUrl","config","baseUrl","user","uid","token","request","then","res","code","pageinfo","pagenum","data","lazyImg","getScrollPage","length","i","push","url","history","path","Fragment","map","item","index","key","className","Css","onClick","pushPage","bind","ordernum","status","satus","goods","item2","index2","data-echo","image","src","require","alt","title","amount","e","stopPropagation","gid","isreview","total","React","Component","connect"],"mappings":"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","file":"static/js/32.6af4756f.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/lazyImg.639beef7.jpg\";","/*eslint-disable*/\nvar UpRefresh=function(opts,callback){\n    if(opts instanceof Object) {\n        this.opts = opts;\n        this.iMaxPage=this.opts.maxPage;\n        this.fnCallback=callback;\n        this.iOffsetBottom=this.opts.offsetBottom;\n        this.iCurPage=this.opts.curPage;\n        this.init();\n    }\n};\nUpRefresh.prototype={\n    init:function(){\n        var _this=this;\n        _this.eventScroll();\n    },\n    eventScroll:function(){\n        var _this=this;\n        window.addEventListener(\"scroll\",_this.scrollBottom());\n    },\n    scrollBottom:function(){\n        var _this=this;\n        var bScroll=true;\n        return function(){\n            if(!bScroll){\n                return;\n            }\n            bScroll=false;\n            setTimeout(function(){\n                //整个页面滚动条的高度\n                var iScrollHeight=document.documentElement.offsetHeight || document.body.offsetHeight;\n                //滚动到当前的距离\n                var iScrollTop=document.documentElement.scrollTop || document.body.scrollTop;\n                //整个窗体的高度\n                var iWinHeight=document.documentElement.clientHeight || document.body.clientHeight;\n                if(iScrollHeight-(iWinHeight+iScrollTop)<=_this.iOffsetBottom){\n                    if(_this.iCurPage<_this.iMaxPage) {\n                        _this.iCurPage++;\n                        _this.fnCallback(_this.iCurPage);\n                    }\n                }\n                bScroll=true;\n            },100);\n        }\n    }\n};\n\n//这个判断支持模块化比如react和vue\nif ( typeof module != 'undefined' && module.exports ) {\n    module.exports = UpRefresh;\n} else if ( typeof define == 'function' && define.amd ) {\n    define( function () { return UpRefresh; } );\n} else if(typeof window != \"undefined\") {\n    window.UpRefresh = UpRefresh;\n}\n\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"order-list\":\"review_order-list__3DAga\",\"ordernum-wrap\":\"review_ordernum-wrap__3Nth8\",\"ordernum\":\"review_ordernum__1V2Q3\",\"status\":\"review_status__2_JZE\",\"item-list\":\"review_item-list__1G2wJ\",\"image\":\"review_image__1b1iL\",\"title\":\"review_title__YsV3y\",\"amount\":\"review_amount__1zl_G\",\"status-btn\":\"review_status-btn__3NrOs\",\"total-wrap\":\"review_total-wrap__1DzSx\",\"total\":\"review_total__E6ani\"};","import React from 'react';\r\nimport {connect} from \"react-redux\";\r\nimport Css from '../../../assets/css/user/myorder/review.module.css';\r\nimport { request } from '../../../assets/js/libs/request.js';\r\nimport UpRefresh from \"../../../assets/js/libs/uprefresh.js\";\r\nimport {safeAuth,lazyImg} from '../../../assets/js/utils/util.js';\r\nimport config from '../../../assets/js/conf/config';\r\nclass OrderPage extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        safeAuth(props);\r\n        this.state={\r\n            aOrder:[],\r\n        };\r\n        this.oUpRefresh=null;\r\n        this.curPage=1;\r\n        this.maxPage=0;\r\n        this.offsetBottom=100;\r\n    }\r\n    componentDidMount(){\r\n        this.getData();\r\n    }\r\n    componentWillUnmount(){\r\n        this.oUpRefresh=null;\r\n        this.setState=(state,callback)=>{\r\n            return;\r\n        }\r\n    }\r\n\r\n    //获取待评价订单信息\r\n    getData(){\r\n        let sUrl=config.baseUrl+\"/api/user/myorder/reviewOrder?uid=\"+this.props.state.user.uid+\"&page=\"+this.curPage+\"&token=\"+config.token;\r\n        request(sUrl).then((res)=>{\r\n            if(res.code===200){\r\n                this.maxPage=res.pageinfo.pagenum;\r\n                this.setState({aOrder:res.data},()=>{\r\n                    lazyImg();\r\n                    this.getScrollPage();\r\n                });\r\n            }\r\n        })\r\n        \r\n    }\r\n\r\n    //向下滑动刷新商品列表\r\n    getScrollPage(){\r\n        this.oUpRefresh=new UpRefresh({\"curPage\":this.curPage,\"maxPage\":this.maxPage,\"offsetBottom\":this.offsetBottom},curPage=>{\r\n            let sUrl=config.baseUrl+\"/api/user/myorder/reviewOrder?uid=\"+this.props.state.user.uid+\"&page=\"+this.curPage+\"&token=\"+config.token;\r\n            request(sUrl).then((res)=>{\r\n                if (res.code===200){\r\n                    if (res.data.length>0){\r\n                        let aOrder=this.state.aOrder;\r\n                        for (let i=0;i<res.data.length;i++){\r\n                            aOrder.push(res.data[i]);\r\n                        }\r\n                        this.setState({aOrder:aOrder},()=>{\r\n                            lazyImg();\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        });\r\n       \r\n    }\r\n\r\n    //跳转页面\r\n    pushPage(url){\r\n        this.props.history.push(config.path+url)\r\n    }\r\n    render(){\r\n        return(\r\n            <React.Fragment>\r\n                {\r\n                    this.state.aOrder.length>0?\r\n                        this.state.aOrder.map((item,index)=>{\r\n                            return (\r\n                                <div key={index} className={Css[\"order-list\"]} onClick={this.pushPage.bind(this,\"order/detail?ordernum=\"+item.ordernum)}>\r\n                                    <div className={Css[\"ordernum-wrap\"]}>\r\n                                        <div className={Css[\"ordernum\"]}>订单编号:{item.ordernum}</div>\r\n                                        <div className={Css[\"status\"]}>{item.status===\"0\"?\"待付款\":item.satus===\"1\"?\"待收货\":\"已收货\"}</div>\r\n                                    </div>\r\n                                    \r\n                                    {\r\n                                        item.goods.length>0?\r\n                                            item.goods.map((item2,index2)=>{\r\n                                                return (\r\n                                                    <div key={index2} className={Css[\"item-list\"]} >\r\n                                                        <div className={Css[\"image\"]}><img data-echo={item2.image} src={require(\"../../../assets/images/common/lazyImg.jpg\")} alt={item2.title}/></div>\r\n                                                        <div className={Css[\"title\"]}>{item2.title}</div>\r\n                                                        <div className={Css[\"amount\"]}>x{item2.amount}</div>\r\n                                                        <div className={Css[\"status-btn\"]} onClick={(e)=>{e.stopPropagation();this.pushPage(\"order/add_review?gid=\"+item2.gid+\"&ordernum=\"+item.ordernum)}}>\r\n                                                            {item2.isreview===\"0\"?\"评价\":\"追加评价\"}\r\n                                                        </div>\r\n                                                    </div>\r\n                                                )\r\n                                            })\r\n                                        :''\r\n                                    }\r\n                                    <div className={Css[\"total-wrap\"]}>\r\n                                        <div className={Css[\"total\"]}>实际金额：¥{item.total}</div>\r\n                                    </div> \r\n                                </div>\r\n                            )\r\n                        })\r\n                    :<div className=\"null-item\">您还没有相关的订单</div>\r\n                }\r\n            </React.Fragment>\r\n        );\r\n    }\r\n}\r\nexport default connect((state)=>{\r\n    return {\r\n        state:state\r\n    }\r\n})(OrderPage)"],"sourceRoot":""}